# –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é Neuro_audio –Ω–∞ Ubuntu —Å–µ—Ä–≤–µ—Ä–µ

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ Ubuntu

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/AlexAvdeev1986/neuroaudio.git
```bash
## –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é Neuro_audio –Ω–∞ Ubuntu —Å–µ—Ä–≤–µ—Ä–µ
1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ Ubuntu
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
bash
sudo apt update && sudo apt upgrade -y

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
sudo apt install python3.10-venv
apt install python3-pip
sudo apt install git

```bash
cd neuroaudio
python3 -m venv venv
source venv/bin/activate
```bash
# –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—É–¥–∏–æ

sudo apt install -y ffmpeg

# –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–º—ã —Ç–æ
sudo apt install -y ffmpeg > /dev/null  

```bash
# –î–ª—è –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤

pip install git+https://github.com/openai/whisper.git 

```bash

# —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt
```bash

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt update && sudo apt upgrade -y

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Docker Compose
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
sudo reboot
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx –∏ Certbot
```bash
sudo apt install nginx certbot python3-certbot-nginx -y
```

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞:
```bash
mkdir -p /opt/neuroaudio
cd /opt/neuroaudio
```

### Dockerfile
```dockerfile
FROM python:3.11-slim

WORKDIR /app

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN apt-get update && apt-get install -y \
    ffmpeg \
    && rm -rf /var/lib/apt/lists/*

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ requirements
COPY requirements.txt .

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN pip install --no-cache-dir -r requirements.txt

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
COPY . .

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
RUN mkdir -p /tmp/audio_temp

# –ü–æ—Ä—Ç –¥–ª—è Streamlit
EXPOSE 8501

# Healthcheck
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:8501/_stcore/health || exit 1

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
CMD ["streamlit", "run", "app.py", "--server.port=8501", "--server.address=0.0.0.0", "--server.headless=true", "--server.enableCORS=false", "--server.enableXsrfProtection=false"]
```

### requirements.txt
```txt
streamlit>=1.28.0
openai>=1.3.0
pydub>=0.25.1
python-dotenv>=1.0.0
requests>=2.31.0
```

### docker-compose.yml
```yaml
version: '3.8'

services:
  neuroaudio:
    build: .
    container_name: neuroaudio_app
    restart: unless-stopped
    ports:
      - "127.0.0.1:8501:8501"
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    volumes:
      - ./logs:/app/logs
      - /tmp/audio_temp:/tmp/audio_temp
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8501/_stcore/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    deploy:
      resources:
        limits:
          memory: 2G
        reservations:
          memory: 512M
```

### .env —Ñ–∞–π–ª
```touch .env
nano .env
OPENAI_API_KEY=your_openai_api_key_here
```

```bash
## 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

### nano /etc/nginx/sites-available/neuroaudio
```nginx
server {
    listen 80;
    server_name neuroaudio777.ddns.net;
    
    # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP –Ω–∞ HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name neuroaudio777.ddns.net;
    
    # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (–±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã Certbot)
    ssl_certificate /etc/letsencrypt/live/neuroaudio777.ddns.net/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/neuroaudio777.ddns.net/privkey.pem;
    
    # SSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;
    
    # Security headers
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    
    # –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
    client_max_body_size 100M;
    client_body_timeout 120s;
    client_header_timeout 120s;
    
    # Proxy –∫ Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
    location / {
        proxy_pass http://127.0.0.1:8501;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-Port $server_port;
        
        # –¢–∞–π–º–∞—É—Ç—ã
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
        
        # –î–ª—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π Streamlit
        proxy_buffering off;
    }
    
    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã Streamlit
    location ^~ /static {
        proxy_pass http://127.0.0.1:8501/static/;
    }
    
    # Health check
    location /_stcore/health {
        proxy_pass http://127.0.0.1:8501/_stcore/health;
        access_log off;
    }
}
```

## 5. –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### start.sh
```bash
#!/bin/bash
cd /opt/neuroaudio

# –ü—Ä–æ–≤–µ—Ä–∫–∞ .env —Ñ–∞–π–ª–∞
if [ ! -f .env ]; then
    echo "–û—à–∏–±–∫–∞: .env —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    exit 1
fi

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose up -d --build

echo "Neuroaudio –∑–∞–ø—É—â–µ–Ω!"
echo "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å: docker-compose ps"
echo "–õ–æ–≥–∏: docker-compose logs -f"
```

### stop.sh
```bash
#!/bin/bash
cd /opt/neuroaudio
docker-compose down
echo "Neuroaudio –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
```

### restart.sh
```bash
#!/bin/bash
cd /opt/neuroaudio
docker-compose down
docker-compose up -d --build
echo "Neuroaudio –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω!"
```

### update.sh
```bash
#!/bin/bash
cd /opt/neuroaudio

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose down

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è git)
# git pull origin main

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up -d --build

echo "Neuroaudio –æ–±–Ω–æ–≤–ª–µ–Ω –∏ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω!"
```

## 6. –°–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### nano /etc/systemd/system/neuroaudio.service
```ini
[Unit]
Description=Neuroaudio Docker Service
Requires=docker.service
After=docker.service

[Service]
Type=oneshot
RemainAfterExit=yes
WorkingDirectory=/root/neuroaudio
ExecStart=/usr/local/bin/docker-compose up -d
ExecStop=/usr/local/bin/docker-compose down
TimeoutStartSec=0

[Install]
WantedBy=multi-user.target
```

## 7. –ü–æ—à–∞–≥–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
sudo mkdir -p /opt/neuroaudio
sudo chown $USER:$USER neuroaudio
cd neuroaudio

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–æ–≤ Python
# app.py, audio_utils.py, openai_utils.py, config.py

# –°–æ–∑–¥–∞–Ω–∏–µ Dockerfile, docker-compose.yml, requirements.txt
# (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—ã—à–µ)

# –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
echo "OPENAI_API_KEY=your_actual_api_key_here" > .env
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
```bash
chmod +x neuroaudio/*.sh
sudo chown -R $USER:$USER neuroaudio
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞ Nginx
sudo cp neuroaudio/nginx.conf /etc/nginx/sites-available/neuroaudio
sudo ln -s /etc/nginx/sites-available/neuroaudio /etc/nginx/sites-enabled/
sudo rm /etc/nginx/sites-enabled/default

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Nginx
sudo systemctl restart nginx
```

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–º–µ–Ω neuroaudio777.ddns.net —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä
sudo certbot --nginx -d neuroaudio777.ddns.net

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
sudo crontab -e
# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
# 0 12 * * * /usr/bin/certbot renew --quiet
```

### 5. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
cd /opt/neuroaudio
./start.sh
```

### 6. –í–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
```bash
sudo systemctl enable neuroaudio
sudo systemctl start neuroaudio
```

## 8. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose logs -f neuroaudio

# –õ–æ–≥–∏ Nginx
sudo tail -f /var/log/nginx/access.log
sudo tail -f /var/log/nginx/error.log

# –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
docker stats
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
```bash
# nano /etc/logrotate.d/neuroaudio
/opt/neuroaudio/logs/*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
    create 0644 root root
    postrotate
        docker-compose -f /root/neuroaudio/docker-compose.yml restart neuroaudio
    endscript
}

## 9. –ë—ç–∫–∞–ø –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### –°–∫—Ä–∏–ø—Ç –±—ç–∫–∞–ø–∞
```bash
#!/bin/bash
BACKUP_DIR="/opt/backups/neuroaudio"
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p $BACKUP_DIR

# –ë—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
tar -czf $BACKUP_DIR/neuroaudio_config_$DATE.tar.gz \
    -C /opt/neuroaudio \
    --exclude=logs \
    .

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find $BACKUP_DIR -name "*.tar.gz" -mtime +30 -delete

echo "–ë—ç–∫–∞–ø —Å–æ–∑–¥–∞–Ω: $BACKUP_DIR/neuroaudio_config_$DATE.tar.gz"
```

## 10. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Firewall –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```bash
sudo ufw allow ssh
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

### Fail2ban –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
```bash
sudo apt install fail2ban -y

# nano /etc/fail2ban/jail.local
[nginx-http-auth]
enabled = true
filter = nginx-http-auth
port = http,https
logpath = /var/log/nginx/error.log

[nginx-noscript]
enabled = true
port = http,https
filter = nginx-noscript
logpath = /var/log/nginx/access.log
maxretry = 6
```

## 11. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://neuroaudio777.ddns.net
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∞–π—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ HTTPS
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∞—É–¥–∏–æ—Ñ–∞–π–ª

## –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã 
1. üì¶ –û—á–∏—Å—Ç–∏ Docker
```bash
docker ps
docker stop <id container>
docker rm <id container>
docker system prune -a --volumes